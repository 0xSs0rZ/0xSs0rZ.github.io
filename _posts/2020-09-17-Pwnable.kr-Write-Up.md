---
layout: post
title: Pwnable.kr - Write-up
subtitle: Pwnable.kr - Sytem exploitation
gh-repo: 0xSs0rZ/0xSs0rZ.github.io
gh-badge: [star]
tags: [CTF, Linux, pwn, pwnable.kr, C, C++, system exploit]
comments: false
---

![Logo](/img/Pwnable_logo_1.png){: .center-block :}
![Logo](/img/Pwnable_logo_2.png){: .center-block :}

## fd

![Logo](/img/Pwnable_logo_fd.png){: .center-block :}

~~~
Mommy! what is a file descriptor in Linux?
~~~

3 types of file descriptors:

0: standard input
1: standard output
2: standard error

Ref: [File descriptors](https://www.bottomupcs.com/file_descriptors.xhtml)

![Code](/img/Pwnable_fd_1.png){: .center-block :}

flag est lisible par fd_pown

fd est SUID

Code source fd.c

![Code](/img/Pwnable_fd_2.png){: .center-block :}

Le programme prend le premier argument, lui soustrait 0x1234, et lit 32 bytes du descripteur de fichier (fd) avec ce numéro. Si le résultat est “LETMEWIN”, le programme retourne le flag

argv[1] = 0x1234 +0 : stdin
argv[1] = 0x1234 +1 : stdout
argv[1] = 0x1234 +2 : stderr

Si nous demandons au programme de lire 32 bytes de stdin alors le programme se mettra en pause et attendra qu'on entre des données (stdin). On pourra alors entrer “LETMEWIN”

0x123 = 4660 en décimal

Solution:

./fd 4660

![Code](/img/Pwnable_fd_3.png){: .center-block :}

Source:

[Checkpoint](https://research.checkpoint.com/wp-content/uploads/2020/03/pwnable_writeup.pdf)

A compléter

**Poursuivez avec :** 

[- CSAW CTF Quals 2020](https://0xss0rz.github.io/2020-09-14-CSAW-CTF-Quals-2020/)

[- HTB - Magic Machine](https://0xss0rz.github.io/2020-08-24-HTB-Magic/)

[![CC-BY](https://mirrors.creativecommons.org/presskit/buttons/88x31/svg/by.svg)](https://creativecommons.org/licenses/by/4.0/)

This work is licensed under a [Creative Commons Attribution 4.0 International License](https://creativecommons.org/licenses/by/4.0/).
