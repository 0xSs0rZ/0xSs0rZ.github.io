---
layout: post
title: CSAW CTF Quals 2020
subtitle: Web, crypto, etc. 
gh-repo: 0xSs0rZ/0xSs0rZ.github.io
gh-badge: [star]
tags: [CTF, Web, Crypto, zwsp, Zero-width space, Xor, png]
comments: false
---

## Sanity - sanity - 5 points

~~~
Join our discord: https://discord.gg/dwYNJ7M
~~~

On se connecte et dans le channel #Rules on trouve le flag:

![Sanity](/img/csaw20_sanity.png){: .center-block :}

## Web - Widthless - 50 points

~~~
Welcome to web! Let's start off with something kinda funky :)  http://web.chal.csaw.io:5018
~~~

![Widthless](/img/csaw20_widthless_1.png){: .center-block :}

~~~
root@Host-001:~/Bureau/OTA/csaw_quals_2020# wget http://web.chal.csaw.io:5018/
--2020-09-12 07:48:30--  http://web.chal.csaw.io:5018/
Résolution de web.chal.csaw.io (web.chal.csaw.io)… 216.165.2.41
Connexion à web.chal.csaw.io (web.chal.csaw.io)|216.165.2.41|:5018… connecté.
requête HTTP transmise, en attente de la réponse… 200 OK
Taille : 5858 (5,7K) [text/html]
Sauvegarde en : « index.html »

index.html          100%[===================>]   5,72K  --.-KB/s    ds 0,002s  

2020-09-12 07:48:30 (3,24 MB/s) — « index.html » sauvegardé [5858/5858]

root@Host-001:~/Bureau/OTA/csaw_quals_2020# xxd index.html 
~~~

En analysant l'hexadecimal, on trouve des caractères 'invisibles':

![Widthless](/img/csaw20_widthless_2.png){: .center-block :}

Ces caractères sont également visibles si on ouvre index.html avec Vim:

![Widthless](/img/csaw20_widthless_3.png){: .center-block :}

On trouve aussi un commentaire ‘zwsp is fun’. Voir [https://en.wikipedia.org/wiki/Zero-width_space](https://en.wikipedia.org/wiki/Zero-width_space)

![Widthless](/img/csaw20_widthless_4.png){: .center-block :}

Ref: [https://rawsec.ml/en/HackIT-2018-write-ups/#1-get-going-misc](https://rawsec.ml/en/HackIT-2018-write-ups/#1-get-going-misc)

On va utiliser: [https://github.com/offdev/zwsp-steg-js](https://github.com/offdev/zwsp-steg-js)

javascript decode.js:

![Widthless](/img/csaw20_widthless_5.png){: .center-block :}

{: .box-warning}
**Warning:**Les caractères unicode ne sont pas visibles avec cat

~~~
root@Host-001:~/Bureau/OTA/csaw_quals_2020# cat decode.js
const ZwspSteg = require('zwsp-steg');

let decoded = ZwspSteg.decode('</html>​​​​‎‏‎​​​');

console.log(decoded);
 
root@Host-001:~/Bureau/OTA/csaw_quals_2020# node decode.js 
b'YWxtMHN0XzJfM3o='

root@Host-001:~/Bureau/OTA/csaw_quals_2020# echo YWxtMHN0XzJfM3o= | base64 -d
alm0st_2_3z
~~~

{: .box-note}
**Note:**Flag: alm0st_2_3z

## Crypto - Perfect Secrecy - 50 points

~~~
Alice sent over a couple of images  with sensitive information to Bob, encrypted with a pre-shared key. It  is the most secure encryption scheme, theoretically...
~~~

2 images image1.png et image2.png sont téléchargeables.

Image 1:

![Xor](/img/csaw20_perfect_secrecy_1.png){: .center-block :}

Image 2: 

![Xor](/img/csaw20_perfect_secrecy_2.png){: .center-block :}

Ref: 

- [http://dann.com.br/alexctf2k17-crypto100-many_time_secrets/](http://dann.com.br/alexctf2k17-crypto100-many_time_secrets/)
- [https://blog.hackeriet.no/shortest-image-xor/](https://blog.hackeriet.no/shortest-image-xor/)

Xor image1 et image2:

~~~
root@Host-001:~/Bureau/OTA/csaw_quals_2020# convert image1.png image2.png -fx "(((255*u)&(255*(1-v)))|((255*(1-u))&(255*v)))/255" C.png
convert-im6.q16: iCCP: profile 'ICC Profile': 'RGB ': RGB color space not permitted on grayscale PNG `image1.png' @ warning/png.c/MagickPNGWarningHandler/1667.
root@Host-001:~/Bureau/OTA/csaw_quals_2020#
~~~

On ouvre C.png:

![Xor](/img/csaw20_perfect_secrecy_3.png){: .center-block :}

~~~
root@Host-001:~/Bureau/OTA/csaw_quals_2020# echo 'ZmxhZ3swbjNfdDFtM19QQGQhfQ==' | base64 -d
flag{0n3_t1m3_P@d!}root@Host-001:~/Bureau/OTA/csaw_quals_2020# 
~~~

**Poursuivez avec :** 

[- Oneliner Shells](https://0xss0rz.github.io/2020-05-10-Oneliner-shells/)

[- HTB - Write Up Machine](https://0xss0rz.github.io/2020-08-04-HTB-Write-Up/)

[![CC-BY](https://mirrors.creativecommons.org/presskit/buttons/88x31/svg/by.svg)](https://creativecommons.org/licenses/by/4.0/)

This work is licensed under a [Creative Commons Attribution 4.0 International License](https://creativecommons.org/licenses/by/4.0/).
